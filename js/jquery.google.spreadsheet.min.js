// jquery.google.spreadsheet.js
// version : 0.0.1
// author : Queli Coto (quelicm@gmail.com)
// license : MIT
// http://quelicoto.es
var GoogleSpreadsheet=function(e){function n(){}var t={};n.prototype.getGoogleUrl=function(){return t};n.prototype.url=function(e){t=this.getGoogleUrl();t.sourceIdentifier=e;if(t.sourceIdentifier.match(/http(s)*:/)){t.url=t.sourceIdentifier;try{t.key=t.url.match(/key=(.*?)&/)[1]}catch(n){t.key=t.url.match(/(cells|list)\/(.*?)\//)[2]}try{t.gid=t.url.match(/gid=(.?)/)[1];if(t.gid!=="0"){var r=6+parseInt(t.gid,10);t.gid="od"+r.toString()}else{t.gid="od6"}}catch(n){t.gid="od6"}}else{t.key=t.sourceIdentifier}t.jsonCellsUrl="http://spreadsheets.google.com/feeds/cells/"+t.key+"/"+t.gid+"/public/basic?alt=json-in-script";t.jsonListUrl="http://spreadsheets.google.com/feeds/list/"+t.key+"/"+t.gid+"/public/basic?alt=json-in-script"};n.prototype.load=function(){var t=arguments;if(t.length>1&&t[0]==="cell"){e.when(this.loadCells()).then(function(e){return t[1](e)})}else{e.when(this.loadList()).then(function(e){return t[0](e)})}};n.prototype.loadCells=function(r){t=this.getGoogleUrl();return e.Deferred(function(i){r=t.jsonCellsUrl+"&callback=?";e.getJSON(r,function(e){var t=n.loadDataCells(e);i.resolve(t)})})};n.loadDataCells=function(e){var t;var n,r,i,s;i=e.feed.entry;s=[];for(n=0,r=i.length;n<r;n++){t=i[n];var o=t.content.$t;s.push(t.content.$t)}return s};n.prototype.loadList=function(r){t=this.getGoogleUrl();return e.Deferred(function(i){r=t.jsonListUrl+"&callback=?";e.getJSON(r,function(e){var t=n.loadDataList(e);i.resolve(t)})})};n.loadDataList=function(t){var n,r,i;var s,o,u,a;u=t.feed.entry;a={};a["items"]=[];for(s=0,o=u.length;s<o;s++){n=u[s];var f=n.content.$t;var l=n.title.$t;var c=f.split(", ");var h={id:l};for(var p=0;p<c.length;p++){var d=c[p].split(": ");h[d[0]]=e.trim(d[1])}a.items.push(h)}return a};return n}(jQuery)